#!/usr/bin/env bash

BIN_DIR=$(dirname "$(realpath "$0")")
ROOT_DIR=$(realpath "${BIN_DIR}/..")
SERVICE_FILE="${ROOT_DIR}/aelia.service"

cat >"${SERVICE_FILE}" << EOF
[Unit]
Description=Aelia DeviantArt Viewer
After=postgresql.service

[Service]
Type=simple
User=${USER}
ExecStart=${BIN_DIR}/start

[Install]
WantedBy=multi-user.target
EOF
echo "Generated serivce file at: ${SERVICE_FILE}" >&2

echo "Symlinking using \"sudo\".  This may prompt for your password."
sudo ln -s "${SERVICE_FILE}" /etc/systemd/system/

cat >&2 << EOF
To start the service now you can run:
  $ systemctl start aelia

To automatically start on boot you can run:
  $ systemctl enable aelia
EOF
